{
  "$schema": "../schema/gather-rule.schema.json",
  "rules": [
    {
      "ruleId": "GATHER-DEVICE-001",
      "title": "Collect dsregcmd join status",
      "description": "Runs dsregcmd /status to capture the Azure AD / Entra join state when the device enters the Device Preparation phase.",
      "category": "device",
      "version": "1.0.0",
      "author": "Autopilot Monitor",
      "enabled": false,
      "collectorType": "command_allowlisted",
      "target": "dsregcmd /status",
      "trigger": "phase_change",
      "triggerPhase": "DevicePreparation",
      "outputEventType": "gather_dsregcmd_status",
      "outputSeverity": "Info",
      "tags": [
        "device",
        "entra",
        "join"
      ]
    },
    {
      "ruleId": "GATHER-DEVICE-002",
      "title": "Collect last system startup event",
      "description": "Collects the most recent Event ID 12 (Kernel-General) from the System log which indicates the last OS startup time.",
      "category": "device",
      "version": "1.0.0",
      "author": "Autopilot Monitor",
      "enabled": false,
      "collectorType": "eventlog",
      "target": "System",
      "parameters": {
        "eventId": "12",
        "source": "Microsoft-Windows-Kernel-General",
        "maxEntries": "1"
      },
      "trigger": "startup",
      "outputEventType": "gather_last_startup_event",
      "outputSeverity": "Info",
      "tags": [
        "device",
        "startup",
        "boot"
      ]
    }
  ]
}
