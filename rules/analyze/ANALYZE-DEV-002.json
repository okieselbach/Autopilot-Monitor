{
  "$schema": "../schema/analyze-rule.schema.json",
  "ruleId": "ANALYZE-DEV-002",
  "title": "High Memory Usage During Enrollment",
  "description": "Detects when memory usage exceeds 90% during enrollment, which can cause app installation failures or system instability.",
  "severity": "warning",
  "category": "device",
  "enabled": true,
  "baseConfidence": 55,
  "conditions": [
    {
      "signal": "high_memory",
      "source": "event_type",
      "eventType": "performance_snapshot",
      "dataField": "memory_used_percent",
      "operator": "gt",
      "value": "90",
      "required": true
    }
  ],
  "confidenceFactors": [
    { "signal": "app_failed", "condition": "exists", "weight": 20 },
    { "signal": "enrollment_failed", "condition": "exists", "weight": 15 }
  ],
  "explanation": "Memory usage exceeded 90% during enrollment. High memory pressure can cause app installation failures, system slowdowns, and ESP timeouts.",
  "remediation": [
    {
      "title": "Reduce memory pressure",
      "steps": [
        "Review which apps are being installed concurrently during ESP",
        "Consider staggering resource-heavy installations",
        "Check minimum RAM requirements for the device (8 GB recommended)",
        "Investigate if background services are consuming excessive memory"
      ]
    }
  ],
  "tags": ["device", "memory", "performance"]
}
